{% load static %}

<html>
	<head>
		<title>My app with forms</title>
      <script src="https://cdn.jsdelivr.net/npm/vue@2.5.16/dist/vue.js"></script>
      <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/vue@2.5.16/dist/vue.js"></script>
      <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.1/css/bulma.min.css"></script> -->
      <link rel="stylesheet" href="{% static "css/main.css" %}">
      <link rel="stylesheet" href="{% static "css/bulma.min.css" %}">
	</head>
	<body>
		<div class="container" id="app">
            <h1 class="title">My Posts</h1>
            <project-list inline-template>
                <div v-cloak class="columns control">
                    <div class="column" v-for="project in projects" :key="project.pk">
                        <project v-bind:project="project"></project>
                    </div>
                </div>
			</project-list>

            <h1 class="title">Add a Post</h1>
            <form method="POST" id="addPost" action="">
              {% csrf_token %}
                <div class="field">
                  <label for="name" class="label">Name</label>
                  <div class="control">
                      <!-- <input class="input" name="name" type="text" id="name" placeholder="Enter A Name" v-model="name"> -->
                      <custom-input class="input" v-model="name"> </custom-input>
                  </div>
                </div>
                <div class="field">
                  <label for="description" class="label">Description</label>
                  <div class="control">
                      <!-- <input class="input" name="description" id="description" placeholder="Enter a Description" v-model="description"> -->
                      <custom-input class="input" v-model="description"> </custom-input>
                  </div>
                </div>
                <div class="control">
                    <button class="button is-primary" type="submit" v-on:click.prevent="addPost">Submit</button>
                </div>
            </form>
        </div>
        <script type="text/javascript">
          
          var InputVue = Vue.component('custom-input', {
            props: ['value'],
            template: `
              <input
                v-bind:value="value" 
                v-on:input="$emit('input', $event.target.value)" 
                placeholder="Add A Name"
              >
            `
          });

          var vue_post = new Vue({
            el: '#addPost',
            data: {
              name: '',
              description: ''
            },
            methods: {
              addPost: function(event){
                axios.post('', {
                  data: {
                    name: this.name,
                    description: this.description
                  },
                })
                .then(response => console.log(response))
                .catch(response => console.log(response))
              }
            }
          })

        </script>
		<!-- <script type="text/javascript" src="{% static "js/vue_post.js" %}"></script> -->
	</body>
</html>